function toggleAccordion(e){e.classList.toggle("active"),e.nextElementSibling.classList.toggle("show"),activeAccordion=e.classList.contains("active")?e:null}function validateInput(e){var t=document.querySelector("#"+e.id+" ~ span");return e===messageInput?validateMessageInput(e,t):e.checkValidity()?(t.classList.remove("error-message"),!0):(t.classList.add("error-message"),!1)}function validateMessageInput(e,t){var n=!1,o=e.value;return console.log(o),""==o&&(t.textContent="Por favor, introduce un mensaje",n=!0),countWords(o)>150&&(t.textContent="Por favor, el mensaje no puede exceder de 150 palabras",n=!0),n?t.classList.add("error-message"):t.classList.remove("error-message"),!n}function countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),(e=e.replace(/\n /,"\n")).split(" ").length}function sendNotification(e){if(notificationData=formatNotification(e),"Notification"in window)if("granted"===Notification.permission)new Notification(notificationData.message,notificationData.options);else"denied"!==Notification.permission&&Notification.requestPermission(function(e){if("granted"===e)new Notification(notificationData.message,notificationData.options)});else alert(notificationData.message+"\n"+notificationData.options.body)}function formatNotification(e){return{message:"Hola, "+e.name,options:{body:"He recibido tu mensaje y en breve te contestaré a "+e.email}}}for(var navbar=document.querySelector("nav.navbar"),header=document.querySelector("header.header"),sections=document.getElementsByTagName("section"),navbarItems=document.getElementsByClassName("navbar-item"),actualSection,scrollSpy=!0,firstScrollAfterNavigation=!1,cumulativeOffset=function(e){var t=0;do{t+=e.offsetTop||0,e=e.offsetParent}while(e);return t},deleteActiveClass=function(){var e=document.getElementsByClassName("navbar-item active");e.length&&e[0].classList.remove("active")},setElementAsActualSection=function(e){(actualSection=e)===header?navbar.classList.remove("navbar-opaque"):navbar.classList.add("navbar-opaque")},getElementByNameAndScroll=function(e){var t;t=""===e?document.getElementsByClassName("header")[0]:document.getElementById(e),scrollToElement(t,2)},getElementPosition=function(e){var t=window.pageYOffset+e.getBoundingClientRect().top;return t=0==t?0:t-navbar.scrollHeight,document.body.scrollHeight-t<window.innerHeight&&(t=document.body.scrollHeight-window.innerHeight),t},easing=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},scrollToElement=function(e,t){var n=window.pageYOffset,o=getElementPosition(e)-n;if(0!==o){var i,a=parseInt(Math.abs(o)/t);setElementAsActualSection(e),scrollSpy=!1,window.requestAnimationFrame(function e(t){var s=t-(i=i||t),r=easing(Math.min(s/a,1));window.scrollTo(0,n+o*r),s<=a?window.requestAnimationFrame(e):(scrollSpy=!0,o>0&&(firstScrollAfterNavigation=!0))})}},changeMenuStyle=function(){if(scrollSpy&&sections.length)if(firstScrollAfterNavigation)firstScrollAfterNavigation=!1;else if(window.pageYOffset<sections[0].cumulativeOffset)actualSection!==header&&(deleteActiveClass(),document.querySelector("a[href='#']").parentNode.classList.add("active"),setElementAsActualSection(header));else for(var e=sections.length-1;e>=0;e--)window.pageYOffset>=sections[e].cumulativeOffset&&(actualSection!==sections[e]&&(deleteActiveClass(),document.querySelector("a[href$='"+sections[e].id+"']").parentNode.classList.add("active"),setElementAsActualSection(sections[e])),e=0)},i=0;i<sections.length;i++)sections[i].cumulativeOffset=cumulativeOffset(sections[i])-navbar.scrollHeight;for(var i=0;i<navbarItems.length;i++)navbarItems[i].addEventListener("click",function(e){deleteActiveClass(),this.classList.add("active");var t=this.getElementsByTagName("a")[0].href.split("#");if(t.length>1){e.preventDefault();var n=t[t.length-1];getElementByNameAndScroll(n)}});window.addEventListener("scroll",changeMenuStyle);for(var acc=document.getElementsByClassName("accordion-item"),activeAccordion,i=0;i<acc.length;i++)acc[i].onclick=function(){activeAccordion&&activeAccordion!==this&&toggleAccordion(activeAccordion),toggleAccordion(this)};var form=document.getElementById("contact-form"),nameInput=document.getElementById("form-name"),emailInput=document.getElementById("form-email"),phoneInput=document.getElementById("form-phone"),messageInput=document.getElementById("form-message"),knownInputs=document.getElementsByName("form-known"),otherHiddenMessage=document.getElementById("known-other").parentNode.lastElementChild,otherInput=document.createElement("input");otherInput.setAttribute("id","form-other"),otherInput.setAttribute("type","text"),otherInput.setAttribute("name","other"),otherInput.setAttribute("placeholder","Cómo me has conocido"),otherInput.setAttribute("required",""),otherInput.style.marginTop="20px";for(var i=0;i<knownInputs.length;i++)knownInputs[i].addEventListener("click",function(e){"other"==this.value?(this.parentNode.insertBefore(otherInput,otherHiddenMessage),otherInput.focus()):document.getElementById("form-other")&&this.parentNode.removeChild(otherInput)});form.addEventListener("submit",function(e){if(e.preventDefault(),!validateInput(nameInput))return nameInput.focus(),!1;if(!validateInput(emailInput))return emailInput.focus(),!1;if(!validateInput(phoneInput))return phoneInput.focus(),!1;if(!validateInput(messageInput))return messageInput.focus(),!1;if(document.getElementById(otherInput.id)){if(!validateInput(otherInput))return otherInput.focus(),!1}else if(!validateInput(knownInputs[knownInputs.length-1]))return!1;sendNotification({name:form.elements["form-name"].value,email:form.elements["form-email"].value}),document.getElementById(otherInput.id)&&otherInput.parentNode.removeChild(otherInput),form.reset()});